<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="小宇" />


    
    


<meta name="description" content="Shen Yu">
<meta property="og:type" content="website">
<meta property="og:title" content="小宇的博客">
<meta property="og:url" content="http://shenyu.wiki/page/3/index.html">
<meta property="og:site_name" content="小宇的博客">
<meta property="og:description" content="Shen Yu">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小宇的博客">
<meta name="twitter:description" content="Shen Yu">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">
<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">
<link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">

<!-- for mermaid -->


    <link rel="alternate" href="/atom.xml" title="小宇的博客" type="application/atom+xml">



    <link rel="shortcut icon" href="/uploads/siteicon.png">





    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>小宇的博客</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: false,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
	
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/uploads/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">小宇</a></h1>
        </hgroup>

        
        <p class="header-subtitle">文章：113字数：</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="true" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-home icon-2x">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">归档</a></li>
                        
                            <li><a href="/tags/">标签</a></li>
                        
                            <li><a href="/map/">导航</a></li>
                        
                            <li><a href="/message/">留言</a></li>
                        
                            <li><a href="/about/">关于</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:shenyufly@163.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="http://github.com/shenyuflying" title="GitHub"></a>
                            
                                <a class="fa RSS" href="http://1572339ac8.iok.la:34421" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/DTCC/">DTCC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ECPG/">ECPG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Greenplum/">Greenplum</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux使用/">Linux使用</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux编程/">Linux编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OCI/">OCI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ODBC/">ODBC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/">Oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PLSQL/">PLSQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PostgreSQL/">PostgreSQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PostgreSQL使用/">PostgreSQL使用</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PostgreSQL内核/">PostgreSQL内核</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PostgreSQL接口/">PostgreSQL接口</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shell/">Shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/assembly/">assembly</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bug/">bug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cctree/">cctree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cflow/">cflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/codeviz/">codeviz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debug/">debug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dns/">dns</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dnsmasq/">dnsmasq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/doxygen/">doxygen</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/egypt/">egypt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/events/">events</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gdb/">gdb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang/">golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gprof/">gprof</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kcachegrind/">kcachegrind</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mathjax/">mathjax</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nas/">nas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nextcloud/">nextcloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pgxc/">pgxc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/programming/">programming</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sed/">sed</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/valgrind/">valgrind</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wget/">wget</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/基础知识/">基础知识</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/备份还原/">备份还原</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小宇带你学PostgreSQL内核/">小宇带你学PostgreSQL内核</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具/">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开源社区/">开源社区</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/技术分享/">技术分享</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/接口/">接口</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/操作系统/">操作系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库，PostgreSQL/">数据库，PostgreSQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据结构与算法/">数据结构与算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文章/">文章</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/旅行/">旅行</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/本地化/">本地化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/架构/">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/查询优化/">查询优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树莓派/">树莓派</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/汇编调试方法/">汇编调试方法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/爱好/">爱好</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程/">编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程语言/">编程语言</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网站/">网站</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/语言层/">语言层</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/读书/">读书</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/调优/">调优</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于基础软件研发</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">小宇</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/uploads/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">小宇</a></h1>
            </hgroup>
            
            <p class="header-subtitle">文章：113字数：</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">归档</a></li>
                
                    <li><a href="/tags/">标签</a></li>
                
                    <li><a href="/map/">导航</a></li>
                
                    <li><a href="/message/">留言</a></li>
                
                    <li><a href="/about/">关于</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:shenyufly@163.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="http://github.com/shenyuflying" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="http://1572339ac8.iok.la:34421" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-bit-map-sets-sorting" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/04/03/bit-map-sets-sorting/" class="article-date">
      <time datetime="2017-04-03T02:32:06.000Z" itemprop="datePublished">2017-04-03</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/03/bit-map-sets-sorting/">bitmap sets sorting</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <blockquote>
<p>BitMapSet can be a very powerful when used for sorting/finding. Because work can be done in O(N) time for sorting and O(1) for finding. Compared to quick sort algorithm, the data is stored in BitMapSet once the data is read into memory. Compared to hash finding, the data is sorted in BitMapSet. In my test, 1,000,000 numbers can be sorted in less than 0.09s on my respberripi and only occupy 125k of memory.</p>
</blockquote>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术分享/">技术分享</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编程/">编程</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a href="/2017/04/03/bit-map-sets-sorting/#more">阅读全文 >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-awesome-awesome-lots-of-good-stuff" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/26/awesome-awesome-lots-of-good-stuff/" class="article-date">
      <time datetime="2017-03-26T02:32:06.000Z" itemprop="datePublished">2017-03-26</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/26/awesome-awesome-lots-of-good-stuff/">awesome awesome lots of good stuff</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Awesome awesome is a collection of community maintained lists on a wide range of topics. From front-end development to hardware, from Pokémon to machine learning. It’s a great way to discover and learn new things! Sure you will find something you like!<br>Click the <a href="https://github.com/sindresorhus/awesome" target="_blank" rel="external">link</a> to find out more.</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术分享/">技术分享</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编程/">编程</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-traversing-tree-in-preorder-inorder-postorder-and-level-order" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/25/traversing-tree-in-preorder-inorder-postorder-and-level-order/" class="article-date">
      <time datetime="2017-03-25T13:32:06.000Z" itemprop="datePublished">2017-03-25</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/25/traversing-tree-in-preorder-inorder-postorder-and-level-order/">traversing tree in preorder inorder postorder and level order</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>Tree as a very common and useful data structure is worth extensive study. Years after I took the Data-structure lesson when I was in school, for the last few days, I regrab the knowledge of how to implement and tranversing a binary tree in servral ways. Besides of the old ways such as preorder/indorder/postorder to traversing a tree, I learnt new knowledge of ways to traversing a tree: level order traversing. Further more, I knew how to print the graph of the tree using graphviz.</p>
</blockquote>
<center><img src="http://static.zybuluo.com/shenyuflying/d5btsnjedki9jmw8klc8p6it/image_1bc2d7db4nop98t1ukvunk61p9.png" alt="image_1bc2d7db4nop98t1ukvunk61p9.png-29.5kB"> </center><br><center>Fig.1 a binary tree</center>

<p>The graph above is drawn by <code>graphviz</code> using the output data by our traverse program list below. You can easily figure out the several ways of how to traverse such a binary tree:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">root first:	5	3	2	1	4	6	7	8	</div><div class="line">root secnd:	1	2	3	4	5	6	7	8	</div><div class="line">root last:	1	2	4	3	8	7	6	5	</div><div class="line">level out:	5	3	6	2	4	7	1	8</div></pre></td></tr></table></figure>
<p>As you might have seen, the root-second  or the inorder traverse way of such a binary search tree is ordered. In the following section, I will try to (1) constructing a binary tree using basic C structs and pointers. (2) implement different ways of how to traversing a tree.</p>
<h2 id="Constructing-a-binary-tree"><a href="#Constructing-a-binary-tree" class="headerlink" title="Constructing a binary tree"></a>Constructing a binary tree</h2><p>In many books, the <code>Tree</code> and  <code>Node</code> structure often share the same defination. However, it is much more clear if you store them seperatly in two different struct. Therefore, you can store additional info in <code>Tree</code> structure inaddtion to <code>Node</code> structure. Currently, the <code>Tree</code> structure only has a member <code>struct _node *</code> which point to the root of the tree. So, I decided to use the following basic data-structure as the fondation brick of my implementation.<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="number">_</span>node&#123;</div><div class="line">    <span class="keyword">int</span> value;</div><div class="line">    <span class="keyword">struct</span> <span class="number">_</span>node  * left;</div><div class="line">    <span class="keyword">struct</span> <span class="number">_</span>node  * right;</div><div class="line">&#125; Node;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="number">_</span>tree&#123;</div><div class="line">    <span class="keyword">struct</span> <span class="number">_</span>node  *root;</div><div class="line">&#125; Tree;</div><div class="line"></div><div class="line"><span class="function">Tree * <span class="title">new_tree</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    Tree *tree;</div><div class="line"></div><div class="line">    tree = (Tree *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(*tree));</div><div class="line">    tree-&gt;root = <span class="literal">NULL</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> tree;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Function <code>Tree * new_tree()</code> return an empty tree whose root point to <code>NULL</code>.</p>
<h2 id="Inserting-in-to-a-binary-tree"><a href="#Inserting-in-to-a-binary-tree" class="headerlink" title="Inserting in to a binary tree"></a>Inserting in to a binary tree</h2><p>Here we’ll insert values in order so we have a binary search tree. In binary search, lookup and other operations can use the principle of binary search. They allow fast lookup, addition and removal of items, and can be used to implement either dynamic sets of items, or lookup tables that allow finding an item by its key.<br>The insert interface is defined as <code>void insert(Tree *tree, int value)</code>, which we insert an int value into the tree. However, a more portable interface is <code>void insert(Tree *tree, void *ptr)</code> which allowing to store a pointer value in the tree. The pointer can point to any other value/struct.<br>In order to call the insert function recursivily we have a workhorse function <code>insert_internal</code> to do most of the inserting job. Since we have to alter the <code>tree-&gt;root</code> pointer when new node is added into the tree, the working horse function’s defination is <code>static void insert_internal(Node **node, int value)</code> in which the address of <code>tree-&gt;root</code> is passed as the first argument.<br>This part of code is below. When inserting a value, if the current position is pointing to NULL we have to allcate a Node structure and store value in it. Else we compare the value against the current node and insert the smaller value into the left part of the tree and the bigger value into the right part of the tree.<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(Tree *tree, <span class="keyword">int</span> value)</span></span></div><div class="line">&#123;</div><div class="line">  insert_internal(&amp;(tree-&gt;root),value);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insert_internal</span><span class="params">(Node **node, <span class="keyword">int</span> value)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(*node == <span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        Node * new_node = (Node *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(*node));</div><div class="line">        new_node-&gt;left = <span class="literal">NULL</span>;</div><div class="line">        new_node-&gt;right = <span class="literal">NULL</span>;</div><div class="line">        new_node-&gt;value = value;</div><div class="line">        *node = new_node;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (value &gt; (*node)-&gt;value)</div><div class="line">      insert_internal(&amp;((*node)-&gt;right), value);</div><div class="line">    <span class="keyword">else</span></div><div class="line">      insert_internal(&amp;((*node)-&gt;left), value);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Preorder-traversing"><a href="#Preorder-traversing" class="headerlink" title="Preorder traversing"></a>Preorder traversing</h2><p>Pre-order traversing, also known as root-first traversing(which is more clear), is done by visiting the root first, then the left child, the the right child.</p>
<h3 id="by-using-recursive"><a href="#by-using-recursive" class="headerlink" title="by using recursive"></a>by using recursive</h3><p>Recursive make the preorder traversing much simpler and more clear to implement. Much the same as inserting we have two separte functions to do the job. The latter one <code>print_internal</code> is mainly used for recurse purposes.<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span>   <span class="title">print</span><span class="params">(Tree *tree)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(tree-&gt;root == <span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"(null)"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"root first:\t"</span>);</div><div class="line">    print_internal(tree-&gt;root);</div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print_internal</span><span class="params">(Node *node)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(node!=<span class="literal">NULL</span>)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\t"</span>, node-&gt;value);</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(node-&gt;left!=<span class="literal">NULL</span>)</div><div class="line">        print_internal(node-&gt;left);</div><div class="line">    <span class="keyword">if</span>(node-&gt;right!=<span class="literal">NULL</span>)</div><div class="line">        print_internal(node-&gt;right);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="by-using-stack"><a href="#by-using-stack" class="headerlink" title="by using stack"></a>by using stack</h3><p>If we are not using recursive ways, we can also use stack to do the same. This saves lots of function calls which is likely to be much more faster.<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span>   <span class="title">print5</span><span class="params">(Tree *tree)</span></span></div><div class="line">&#123;</div><div class="line">    Stack *<span class="built_in">stack</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(tree-&gt;root == <span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"(null)"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">stack</span> = new_stack();</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"root first:\t"</span>);</div><div class="line">    print_internal5(<span class="built_in">stack</span>,tree-&gt;root);</div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print_internal5</span><span class="params">(Stack *<span class="built_in">stack</span>, Node *node)</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(node!=<span class="literal">NULL</span>)</div><div class="line">        push(<span class="built_in">stack</span>,(<span class="keyword">void</span> *)node);</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(!is_stack_empty(<span class="built_in">stack</span>))</div><div class="line">    &#123;</div><div class="line">        Node *top;</div><div class="line"></div><div class="line">        top = (Node *)pop(<span class="built_in">stack</span>);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\t"</span>,top-&gt;value);</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(top-&gt;right!=<span class="literal">NULL</span>)</div><div class="line">          push(<span class="built_in">stack</span>,(<span class="keyword">void</span> *)top-&gt;right);</div><div class="line">        <span class="keyword">if</span>(top-&gt;left!=<span class="literal">NULL</span>)</div><div class="line">          push(<span class="built_in">stack</span>,(<span class="keyword">void</span> *)top-&gt;left);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>It is worth noticing, we have to push right part of the tree first and left part of the tree last, since the stack is LIFO data structure. So the left part is poped out first in the next loop. When the left part is poped out, its value is printed and the right/left part is pushed on the top of the stack. So, always the root first then the left part then the right part.</p>
<h2 id="inorder-traversing"><a href="#inorder-traversing" class="headerlink" title="inorder traversing"></a>inorder traversing</h2><p>The inorder traversing is done by visiting the left child first, then the root, then the right child last.<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span>   <span class="title">print2</span><span class="params">(Tree *tree)</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(tree-&gt;root == <span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"(null)"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"root second:\t"</span>);</div><div class="line">    print_internal2(tree-&gt;root);</div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print_internal2</span><span class="params">(Node *node)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(node-&gt;left!=<span class="literal">NULL</span>)</div><div class="line">        print_internal2(node-&gt;left);</div><div class="line">    <span class="keyword">if</span>(node!=<span class="literal">NULL</span>)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\t"</span>, node-&gt;value);</div><div class="line">    <span class="keyword">if</span>(node-&gt;right!=<span class="literal">NULL</span>)</div><div class="line">        print_internal2(node-&gt;right);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="postorder-traversing"><a href="#postorder-traversing" class="headerlink" title="postorder traversing"></a>postorder traversing</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span>   <span class="title">print3</span><span class="params">(Tree *tree)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(tree-&gt;root == <span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"(null)"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"root last:\t"</span>);</div><div class="line">    print_internal3(tree-&gt;root);</div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print_internal3</span><span class="params">(Node *node)</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(node-&gt;left!=<span class="literal">NULL</span>)</div><div class="line">        print_internal3(node-&gt;left);</div><div class="line">    <span class="keyword">if</span>(node-&gt;right!=<span class="literal">NULL</span>)</div><div class="line">        print_internal3(node-&gt;right);</div><div class="line">    <span class="keyword">if</span>(node!=<span class="literal">NULL</span>)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\t"</span>, node-&gt;value);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="level-order-traversing"><a href="#level-order-traversing" class="headerlink" title="level order traversing"></a>level order traversing</h2><p>A queue(FIFO) can be used to do the level traversing of a tree. By put the root in queue, then the left child of the root in queue, then the right child of the tree in queue.<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span>   <span class="title">print4</span><span class="params">(Tree *tree)</span></span></div><div class="line">&#123;</div><div class="line">    Queue *<span class="built_in">queue</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(tree-&gt;root == <span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"(null)"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">queue</span> = new_queue();</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"level out:\t"</span>);</div><div class="line">    print_internal4(<span class="built_in">queue</span>,tree-&gt;root);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print_internal4</span><span class="params">(Queue * <span class="built_in">queue</span>,Node *node)</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(node!=<span class="literal">NULL</span>)</div><div class="line">        inqueue(<span class="built_in">queue</span>,(<span class="keyword">void</span> *)node);</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(!is_queue_empty(<span class="built_in">queue</span>))</div><div class="line">    &#123;</div><div class="line">        Node *front;</div><div class="line"></div><div class="line">        front = (Node *)dequeue(<span class="built_in">queue</span>);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\t"</span>,front-&gt;value);</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(front-&gt;left!=<span class="literal">NULL</span>)</div><div class="line">          inqueue(<span class="built_in">queue</span>,(<span class="keyword">void</span> *)front-&gt;left);</div><div class="line">        <span class="keyword">if</span>(front-&gt;right!=<span class="literal">NULL</span>)</div><div class="line">          inqueue(<span class="built_in">queue</span>,(<span class="keyword">void</span> *)front-&gt;right);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>This algorithm is worth much thinking to have a full understanding of how it works.</p>
<h2 id="Graphic-output"><a href="#Graphic-output" class="headerlink" title="Graphic output"></a>Graphic output</h2><p>Any of the above traversing algorithm can be modified to print the edge between the parent and child. Making it much easy to adapt to the <code>graphviz</code> grammer.<br>One sample of the Fig1 converted to graphviz format is following. Each line representing either a vertex of the tree or the edge of the tree.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">digraph G &#123;</div><div class="line">5</div><div class="line">5 -&gt; 3</div><div class="line">3</div><div class="line">3 -&gt; 2</div><div class="line">2</div><div class="line">2 -&gt; 1</div><div class="line">1</div><div class="line">3 -&gt; 4</div><div class="line">4</div><div class="line">5 -&gt; 6</div><div class="line">6</div><div class="line">6 -&gt; 7</div><div class="line">7</div><div class="line">7 -&gt; 8</div><div class="line">8</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>It is done by the following code:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span>   <span class="title">print_graph</span><span class="params">(Tree *tree)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(tree-&gt;root == <span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"(null)"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"digraph G &#123;\n"</span>);</div><div class="line">    print_graph_internal(tree-&gt;root);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"&#125;\n"</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print_graph_internal</span><span class="params">(Node *node)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(node!=<span class="literal">NULL</span>)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, node-&gt;value);</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(node-&gt;left!=<span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d -&gt; %d\n"</span>, node-&gt;value, node-&gt;left-&gt;value);</div><div class="line">        print_graph_internal(node-&gt;left);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(node-&gt;right!=<span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d -&gt; %d\n"</span>, node-&gt;value, node-&gt;right-&gt;value);</div><div class="line">        print_graph_internal(node-&gt;right);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Later, issue command <code>dot -Tjpg file.dot -o file.jpg</code> to draw the actual graph as shown in figure1.</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术分享/">技术分享</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/">c</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编程/">编程</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-source-insight-color-theme" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/12/source-insight-color-theme/" class="article-date">
      <time datetime="2017-03-12T02:32:06.000Z" itemprop="datePublished">2017-03-12</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/12/source-insight-color-theme/">Source insight color theme</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><img src="http://static.zybuluo.com/shenyuflying/zwofd8d075r44j23do1pabg0/image_1bb1802ofnuv148n1f226261heu9.png" alt="image_1bb1802ofnuv148n1f226261heu9.png-665.5kB"></p>
<p><a href="/uploads/souce-insight-sublime-color-theme.CF3">click to download</a></p>
<h2 id="How-to"><a href="#How-to" class="headerlink" title="How to"></a>How to</h2><ol>
<li>download the file <code>/uploads/souce-insight-sublime-color-theme.CF3</code></li>
<li>open source insight</li>
<li>click Options-&gt;Load configuration</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术分享/">技术分享</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/工具/">工具</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Readings-of-query-optimizer" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/11/Readings-of-query-optimizer/" class="article-date">
      <time datetime="2017-03-11T02:32:06.000Z" itemprop="datePublished">2017-03-11</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/11/Readings-of-query-optimizer/">Readings of query optimizer</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p> Query Optimizer is one of the hard part of  Relational Database Implimentation. A good reading of the related paper will help you understand why the code is implimented as such. Here I choose some of the basic papers of query optimizer.</p>
</blockquote>
<p><a href="https://en.wikipedia.org/wiki/Query_optimization" target="_blank" rel="external">Query optimization Wiki</a> : Fundamentals about query optimization, that’s a good palace to start.<br><a href="http://citeseer.ist.psu.edu/viewdoc/download;jsessionid=D6EAC438BC476CE50F9D7399D1B01E07?doi=10.1.1.137.3356&amp;rep=rep1&amp;type=pdf" target="_blank" rel="external">An Overview of Query Optimization in Relational Systems
</a> : a good review of considerations of query optimizer.<br><a href="https://wenku.baidu.com/view/b1889fd9d15abe23482f4d0c.html" target="_blank" rel="external">Access Path Selection in a Relational Database Management System</a> : Classic System R database optimizer implimentation.</p>
<p>to be cont …</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术分享/">技术分享</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/基础知识/">基础知识</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-For-developers-how-to-build-run-Greenplum-for-debugging-purposes" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/08/For-developers-how-to-build-run-Greenplum-for-debugging-purposes/" class="article-date">
      <time datetime="2017-03-08T02:32:06.000Z" itemprop="datePublished">2017-03-08</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/08/For-developers-how-to-build-run-Greenplum-for-debugging-purposes/">For developers: how to build &amp; run Greenplum for debugging purposes</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>The binary install package downloaded from the official website is not suit for developers. Following reasons: 1) the debug symbol is often not included. 2) there is often a high level of compilier optimization. 3) you cannot match the binary executable with the original source code. As a result, you will find trouble when debugging using gdb. So, developers often dowload the source code and complile it on their own, keeping whatever infos avaliable in the binary executable for debugging. This article is about how to build Greenplum from source code and deploy it on a single machine for developer debugging purposes.</p>
</blockquote>
<h2 id="Install-from-source"><a href="#Install-from-source" class="headerlink" title="Install from source"></a>Install from source</h2><p>The first step of get everything going is always the same: get the source code. The greenplum is currently hosted on github, which you can get the source code like this<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/greenplum-db/gpdb.git</div></pre></td></tr></table></figure></p>
<p>Afterwards, it much the same like all other Linux based software, you have to do the 3 steps: configure, make, make install.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">./configure  CFLAGS=&quot;-O0 -gdwarf-2 -g3&quot; --prefix=`pwd`/release  --with-perl --with-python --with-libxml --enable-mapreduce --enable-debug</div><div class="line">make</div><div class="line">make install</div></pre></td></tr></table></figure></p>
<p>Here we add <code>-O0</code> to the CFLAGS, so that no complier optimization will take place. And we have <code>--enable-debug</code> configuration option set to build all the debugging info in the binary file.  We also add <code>-gdwarf-2 -g3</code> to the CFLAGS so all the defination of  macros is keeped.<br>If you met configure error, it is because you are missing some of the libs refer to FAQ for more info.<br>After you <code>make install</code> the gp database, all the binary executable file will be located under the <code>release</code> directroy.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gpadmin@yshen-ThinkPad-X201:~/gpdb/release$ ls</div><div class="line">bin  conf  demo  doc  docs  greenplum_path.sh  include  lib  sbin  share</div></pre></td></tr></table></figure></p>
<h2 id="Initialization"><a href="#Initialization" class="headerlink" title="Initialization"></a>Initialization</h2><h3 id="layout-of-the-gp-database-cluster"><a href="#layout-of-the-gp-database-cluster" class="headerlink" title="layout of the gp database cluster"></a>layout of the gp database cluster</h3><p>It considered easier to debug  if we only have all segemets installed on one computer. By doing so, it will not cause trouble for you to set up miltiple computers or virtual machines. In the meantime, you still have the basic distribution layout of the system. So the cluster layout is as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">master host</div><div class="line">|</div><div class="line">-----&gt;segment host1 [primary1 primary2 primary3  mirror1 mirror2 mirror3]</div></pre></td></tr></table></figure>
<p>We have master and segement hosts installed on our localhost, and 3 primary segements plus 3 mirror segements installed on segment host which is also localhost. So, alltogether we have 7 postgres backend running on localhost. You can examin how many postgres backend process is running by <code>ps aux | grep bin/postgres | wc -l</code>, in this situation, the output is 7.</p>
<h3 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h3><p>By editing <code>hosts</code> file, the mdw ( master ) and sdw ( segment ) will point to the local host.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cat /etc/hosts</div><div class="line">127.0.0.1 mdw</div><div class="line">127.0.0.1 sdw1</div></pre></td></tr></table></figure></p>
<p>we should also create a file <code>all_hosts</code> to keep a list of all master and segment hosts.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ cat /home/gpadmin/gpdb/release/conf/all_hosts </div><div class="line">mdw</div><div class="line">sdw1</div></pre></td></tr></table></figure></p>
<p>The <code>seg_hosts</code> file only have all the segment hosts.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cat /home/gpadmin/gpdb/release/conf/seg_hosts </div><div class="line">sdw1</div></pre></td></tr></table></figure></p>
<p>Later the two files will be used by <code>gpinitsystem</code> command.</p>
<p>We also have to set up the folder to store the data. Each primary and mirror segment plus the master segment have a folder, in our case there are 7 folders.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mkdir -p /home/gpadmin/gpdata/gpmaster</div><div class="line">mkdir -p /home/gpadmin/gpdata/gpdatap1</div><div class="line">mkdir -p /home/gpadmin/gpdata/gpdatap2</div><div class="line">mkdir -p /home/gpadmin/gpdata/gpdatap3</div><div class="line">mkdir -p /home/gpadmin/gpdata/gpdatam1</div><div class="line">mkdir -p /home/gpadmin/gpdata/gpdatam2</div><div class="line">mkdir -p /home/gpadmin/gpdata/gpdatam3</div></pre></td></tr></table></figure></p>
<h3 id="Ininit-the-system"><a href="#Ininit-the-system" class="headerlink" title="Ininit the system"></a>Ininit the system</h3><p>The file <code>gpinitsystem_config</code> is for the command <code>gpinitsystem</code> to know how many hosts are there in the cluster and how many primary/mirror segments will have on a single host. You can find a sample of configuration file in <code>$GPHOME/docs/cli_help/gpconfigs/gpinitsystem_config</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"># FILE NAME: gpinitsystem_config</div><div class="line"></div><div class="line"># Configuration file needed by the gpinitsystem</div><div class="line"></div><div class="line">################################################</div><div class="line">#### REQUIRED PARAMETERS</div><div class="line">################################################</div><div class="line"></div><div class="line">#### Name of this Greenplum system enclosed in quotes.</div><div class="line">ARRAY_NAME=&quot;Greenplum&quot;</div><div class="line"></div><div class="line">#### Naming convention for utility-generated data directories.</div><div class="line">SEG_PREFIX=gpseg</div><div class="line"></div><div class="line">#### Base number by which primary segment port numbers </div><div class="line">#### are calculated.</div><div class="line">PORT_BASE=40000</div><div class="line"></div><div class="line">#### File system location(s) where primary segment data directories </div><div class="line">#### will be created. The number of locations in the list dictate</div><div class="line">#### the number of primary segments that will get created per</div><div class="line">#### physical host (if multiple addresses for a host are listed in </div><div class="line">#### the hostfile, the number of segments will be spread evenly across</div><div class="line">#### the specified interface addresses).</div><div class="line">declare -a DATA_DIRECTORY=(/home/gpadmin/gpdata/gpdatap1 /home/gpadmin/gpdata/gpdatap2 /home/gpadmin/gpdata/gpdatap3)</div><div class="line"></div><div class="line">#### OS-configured hostname or IP address of the master host.</div><div class="line">MASTER_HOSTNAME=mdw</div><div class="line"></div><div class="line">#### File system location where the master data directory </div><div class="line">#### will be created.</div><div class="line">MASTER_DIRECTORY=/home/gpadmin/gpdata/gpmaster</div><div class="line"></div><div class="line">#### Port number for the master instance. </div><div class="line">MASTER_PORT=5432</div><div class="line"></div><div class="line">#### Shell utility used to connect to remote hosts.</div><div class="line">TRUSTED_SHELL=ssh</div><div class="line">#### Maximum log file segments between automatic WAL checkpoints.</div><div class="line">CHECK_POINT_SEGMENTS=8</div><div class="line"></div><div class="line">#### Default server-side character set encoding.</div><div class="line">ENCODING=UNICODE</div><div class="line"></div><div class="line">################################################</div><div class="line">#### OPTIONAL MIRROR PARAMETERS</div><div class="line">################################################</div><div class="line"></div><div class="line">#### Base number by which mirror segment port numbers </div><div class="line">#### are calculated.</div><div class="line">MIRROR_PORT_BASE=50000</div><div class="line"></div><div class="line">#### Base number by which primary file replication port </div><div class="line">#### numbers are calculated.</div><div class="line">REPLICATION_PORT_BASE=41000</div><div class="line"></div><div class="line">#### Base number by which mirror file replication port </div><div class="line">#### numbers are calculated. </div><div class="line">MIRROR_REPLICATION_PORT_BASE=51000</div><div class="line"></div><div class="line">#### File system location(s) where mirror segment data directories </div><div class="line">#### will be created. The number of mirror locations must equal the</div><div class="line">#### number of primary locations as specified in the </div><div class="line">#### DATA_DIRECTORY parameter.</div><div class="line">declare -a MIRROR_DATA_DIRECTORY=(/home/gpadmin/gpdata/gpdatam1 /home/gpadmin/gpdata/gpdatam2 /home/gpadmin/gpdata/gpdatam3)</div><div class="line"></div><div class="line">################################################</div><div class="line">#### OTHER OPTIONAL PARAMETERS</div><div class="line">################################################</div><div class="line"></div><div class="line">#### Create a database of this name after initialization.</div><div class="line">DATABASE_NAME=postgres</div><div class="line"></div><div class="line">#### Specify the location of the host address file here instead of</div><div class="line">#### with the the -h option of gpinitsystem.</div><div class="line">MACHINE_LIST_FILE=/home/gpadmin/gpdb/release/conf/seg_hosts</div></pre></td></tr></table></figure></p>
<p>Before doing the initialization, we have to add a few environment variable, like <code>GPHOME</code> by doing:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">~/gpdb/release$ source greenplum_path.sh</div></pre></td></tr></table></figure>
<p>The GPHOME is set up by <code>configure</code>, so be sure to make it correct after you move the <code>release</code> folder to another location.<br>Inorder all the paths remain effective, you’d better add all the PATHs to your profile by:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat greenplum_path.sh &gt;&gt; ~/.profile</div></pre></td></tr></table></figure></p>
<blockquote>
<p>NOTICE: in order to run py scripts under bin directoy you have to  <code>export PYTHONPATH=$PYTHONPATH:~/gpdb/gpMgmt/bin/ext</code></p>
</blockquote>
<p>Ok, if you get here we are ready to rock and roll. Start the initialization of the system by typing the command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gpadmin@yshen-ThinkPad-X201:~/gpdb/release/bin$ ./gpinitsystem -c gpinitsystem_config</div></pre></td></tr></table></figure></p>
<p>There will be long list of logs showing what happend.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div></pre></td><td class="code"><pre><div class="line">20170307:21:30:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Checking configuration parameters, please wait...</div><div class="line">20170307:21:30:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Reading Greenplum configuration file gpinitsystem_config</div><div class="line">20170307:21:30:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Locale has not been set in gpinitsystem_config, will set to default value</div><div class="line">20170307:21:30:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Locale set to en_US.utf8</div><div class="line">20170307:21:30:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[WARN]:-Master hostname mdw does not match hostname output</div><div class="line">20170307:21:30:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Checking to see if mdw can be resolved on this host</div><div class="line">20170307:21:30:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Can resolve mdw to this host</div><div class="line">20170307:21:30:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-MASTER_MAX_CONNECT not set, will set to default value 250</div><div class="line">20170307:21:30:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Detected a single host GPDB array build, reducing value of BATCH_DEFAULT from 60 to 4</div><div class="line">20170307:21:30:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[WARN]:-Master open file limit is 1024 should be &gt;= 65535</div><div class="line">20170307:21:30:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Checking configuration parameters, Completed</div><div class="line">20170307:21:30:53:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Commencing multi-home checks, please wait...</div><div class="line">.</div><div class="line">20170307:21:30:53:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Configuring build for standard array</div><div class="line">20170307:21:30:53:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Commencing multi-home checks, Completed</div><div class="line">20170307:21:30:53:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Building primary segment instance array, please wait...</div><div class="line">...</div><div class="line">20170307:21:30:55:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Building group mirror array type , please wait...</div><div class="line">...</div><div class="line">20170307:21:30:57:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Checking Master host</div><div class="line">20170307:21:30:57:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Checking new segment hosts, please wait...</div><div class="line">20170307:21:30:58:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[WARN]:-Host mdw open files limit is 1024 should be &gt;= 65535</div><div class="line">......</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Checking new segment hosts, Completed</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Greenplum Database Creation Parameters</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:---------------------------------------</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master Configuration</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:---------------------------------------</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master instance name       = Greenplum</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master hostname            = mdw</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master port                = 5432</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master instance dir        = /home/gpadmin/gpdata/gpmaster/gpseg-1</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master LOCALE              = en_US.utf8</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Greenplum segment prefix   = gpseg</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master Database            = postgres</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master connections         = 250</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master buffers             = 128000kB</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Segment connections        = 750</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Segment buffers            = 128000kB</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Checkpoint segments        = 8</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Encoding                   = UNICODE</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Postgres param file        = Off</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Initdb to be used          = /home/gpadmin/gpdb/release/bin/initdb</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-GP_LIBRARY_PATH is         = /home/gpadmin/gpdb/release/lib</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[WARN]:-Ulimit check               = Warnings generated, see log file &lt;&lt;&lt;&lt;&lt;</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Array host connect type    = Single hostname per node</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master IP address [1]      = ::1</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master IP address [2]      = 192.168.1.111</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master IP address [3]      = fe80::e181:909d:d2a4:8de0</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Standby Master             = Not Configured</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Primary segment #          = 3</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Total Database segments    = 3</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Trusted shell              = ssh</div><div class="line">20170307:21:31:04:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Number segment hosts       = 1</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Mirror port base           = 50000</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Replicaton port base       = 41000</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Mirror replicaton port base= 51000</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Mirror segment #           = 3</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Mirroring config           = ON</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Mirroring type             = Group</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:----------------------------------------</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Greenplum Primary Segment Configuration</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:----------------------------------------</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-sdw1 	/home/gpadmin/gpdata/gpdatap1/gpseg0 	40000 	2 	0 	41000</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-sdw1 	/home/gpadmin/gpdata/gpdatap2/gpseg1 	40001 	3 	1 	41001</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-sdw1 	/home/gpadmin/gpdata/gpdatap3/gpseg2 	40002 	4 	2 	41002</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:---------------------------------------</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Greenplum Mirror Segment Configuration</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:---------------------------------------</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-sdw1 	/home/gpadmin/gpdata/gpdatam1/gpseg0 	50000 	5 	0 	51000</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-sdw1 	/home/gpadmin/gpdata/gpdatam2/gpseg1 	50001 	6 	1 	51001</div><div class="line">20170307:21:31:05:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-sdw1 	/home/gpadmin/gpdata/gpdatam3/gpseg2 	50002 	7 	2 	51002</div><div class="line"></div><div class="line">Continue with Greenplum creation Yy|Nn (default=N):</div><div class="line">&gt; Y</div><div class="line">20170307:21:31:07:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Building the Master instance database, please wait...</div><div class="line">20170307:21:31:15:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Starting the Master in admin mode</div><div class="line">20170307:21:31:23:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Commencing parallel build of primary segment instances</div><div class="line">20170307:21:31:23:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Spawning parallel processes    batch [1], please wait...</div><div class="line">...</div><div class="line">20170307:21:31:24:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Waiting for parallel processes batch [1], please wait...</div><div class="line">............................</div><div class="line">20170307:21:31:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:------------------------------------------------</div><div class="line">20170307:21:31:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Parallel process exit status</div><div class="line">20170307:21:31:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:------------------------------------------------</div><div class="line">20170307:21:31:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Total processes marked as completed           = 3</div><div class="line">20170307:21:31:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Total processes marked as killed              = 0</div><div class="line">20170307:21:31:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Total processes marked as failed              = 0</div><div class="line">20170307:21:31:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:------------------------------------------------</div><div class="line">20170307:21:31:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Commencing parallel build of mirror segment instances</div><div class="line">20170307:21:31:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Spawning parallel processes    batch [1], please wait...</div><div class="line">...</div><div class="line">20170307:21:31:52:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Waiting for parallel processes batch [1], please wait...</div><div class="line">...................</div><div class="line">20170307:21:32:12:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:------------------------------------------------</div><div class="line">20170307:21:32:12:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Parallel process exit status</div><div class="line">20170307:21:32:12:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:------------------------------------------------</div><div class="line">20170307:21:32:12:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Total processes marked as completed           = 3</div><div class="line">20170307:21:32:12:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Total processes marked as killed              = 0</div><div class="line">20170307:21:32:12:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Total processes marked as failed              = 0</div><div class="line">20170307:21:32:12:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:------------------------------------------------</div><div class="line">20170307:21:32:12:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Deleting distributed backout files</div><div class="line">20170307:21:32:12:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Removing back out file</div><div class="line">20170307:21:32:12:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-No errors generated from parallel processes</div><div class="line">20170307:21:32:12:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Restarting the Greenplum instance in production mode</div><div class="line">20170307:21:32:13:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-Starting gpstop with args: -a -l /home/gpadmin/gpAdminLogs -i -m -d /home/gpadmin/gpdata/gpmaster/gpseg-1</div><div class="line">20170307:21:32:13:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-Gathering information and validating the environment...</div><div class="line">20170307:21:32:13:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-Obtaining Greenplum Master catalog information</div><div class="line">20170307:21:32:13:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-Obtaining Segment details from master...</div><div class="line">20170307:21:32:13:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-Greenplum Version: &apos;postgres (Greenplum Database) 5.0.0-alpha.0-96-g0701a77 build dev&apos;</div><div class="line">20170307:21:32:13:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-There are 0 connections to the database</div><div class="line">20170307:21:32:13:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-Commencing Master instance shutdown with mode=&apos;immediate&apos;</div><div class="line">20170307:21:32:13:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master host=yshen-ThinkPad-X201</div><div class="line">20170307:21:32:13:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-Commencing Master instance shutdown with mode=immediate</div><div class="line">20170307:21:32:13:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master segment instance directory=/home/gpadmin/gpdata/gpmaster/gpseg-1</div><div class="line">20170307:21:32:14:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-Attempting forceful termination of any leftover master process</div><div class="line">20170307:21:32:14:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[INFO]:-Terminating processes for segment /home/gpadmin/gpdata/gpmaster/gpseg-1</div><div class="line">20170307:21:32:14:004724 gpstop:yshen-ThinkPad-X201:gpadmin-[ERROR]:-Failed to kill processes for segment /home/gpadmin/gpdata/gpmaster/gpseg-1: ([Errno 3] No such process)</div><div class="line">20170307:21:32:14:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Starting gpstart with args: -a -l /home/gpadmin/gpAdminLogs -d /home/gpadmin/gpdata/gpmaster/gpseg-1</div><div class="line">20170307:21:32:14:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Gathering information and validating the environment...</div><div class="line">20170307:21:32:14:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Greenplum Binary Version: &apos;postgres (Greenplum Database) 5.0.0-alpha.0-96-g0701a77 build dev&apos;</div><div class="line">20170307:21:32:14:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Greenplum Catalog Version: &apos;301702171&apos;</div><div class="line">20170307:21:32:14:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Starting Master instance in admin mode</div><div class="line">20170307:21:32:15:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Obtaining Greenplum Master catalog information</div><div class="line">20170307:21:32:15:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Obtaining Segment details from master...</div><div class="line">20170307:21:32:15:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Setting new master era</div><div class="line">20170307:21:32:15:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Master Started...</div><div class="line">20170307:21:32:15:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Shutting down master</div><div class="line">20170307:21:32:17:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Commencing parallel primary and mirror segment instance startup, please wait...</div><div class="line">... </div><div class="line">20170307:21:32:20:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Process results...</div><div class="line">20170307:21:32:20:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-----------------------------------------------------</div><div class="line">20170307:21:32:20:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-   Successful segment starts                                            = 6</div><div class="line">20170307:21:32:20:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-   Failed segment starts                                                = 0</div><div class="line">20170307:21:32:20:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-   Skipped segment starts (segments are marked down in configuration)   = 0</div><div class="line">20170307:21:32:20:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-----------------------------------------------------</div><div class="line">20170307:21:32:20:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-</div><div class="line">20170307:21:32:20:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Successfully started 6 of 6 segment instances </div><div class="line">20170307:21:32:20:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-----------------------------------------------------</div><div class="line">20170307:21:32:20:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Starting Master instance yshen-ThinkPad-X201 directory /home/gpadmin/gpdata/gpmaster/gpseg-1 </div><div class="line">20170307:21:32:21:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Command pg_ctl reports Master yshen-ThinkPad-X201 instance active</div><div class="line">20170307:21:32:21:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-No standby master configured.  skipping...</div><div class="line">20170307:21:32:21:004811 gpstart:yshen-ThinkPad-X201:gpadmin-[INFO]:-Database successfully started</div><div class="line">20170307:21:32:21:010106 gpinitsystem:yshen-ThinkPad-X201:gpadmin-[INFO]:-Completed restart of Greenplum instance in production mode</div><div class="line">20170307:21:32:21:gpinitsystem:yshen-ThinkPad-X201:gpadmin-[FATAL]:-Failed to complete create database postgres  Script Exiting!</div></pre></td></tr></table></figure></p>
<h2 id="startup-amp-stop-database-server"><a href="#startup-amp-stop-database-server" class="headerlink" title="startup &amp; stop database server"></a>startup &amp; stop database server</h2><p>There are python script <code>gpstart</code>`gpstop` to start and stop the cluster all at once, so will save your the trouble of start\stop each of the segment by yourself.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gpadmin@yshen-ThinkPad-X201:~/gpdb/release/bin$ ./gpstart -d ~/gpdata/gpmaster/gpseg-1/</div></pre></td></tr></table></figure>
<p>When the cluster is up and running, you can see each segment is running under each’s data directory. And you can tell easily which of them is master segment and primary/mirror segment.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">$ ps aux | grep bin/postgres</div><div class="line">gpadmin   4938  0.3  2.8 426780 230960 ?       Ss   21:32   0:00 /home/gpadmin/gpdb/release/bin/postgres -D /home/gpadmin/gpdata/gpdatap2/gpseg1 -p 40001 --gp_dbid=3 --gp_num_contents_in_cluster=3 --silent-mode=true -i -M quiescent --gp_contentid=1</div><div class="line">gpadmin   4939  0.3  2.8 424808 229148 ?       Ss   21:32   0:00 /home/gpadmin/gpdb/release/bin/postgres -D /home/gpadmin/gpdata/gpdatam2/gpseg1 -p 50001 --gp_dbid=6 --gp_num_contents_in_cluster=3 --silent-mode=true -i -M quiescent --gp_contentid=1</div><div class="line">gpadmin   4944  0.3  2.8 424804 229172 ?       Ss   21:32   0:00 /home/gpadmin/gpdb/release/bin/postgres -D /home/gpadmin/gpdata/gpdatam1/gpseg0 -p 50000 --gp_dbid=5 --gp_num_contents_in_cluster=3 --silent-mode=true -i -M quiescent --gp_contentid=0</div><div class="line">gpadmin   4946  0.3  2.9 426784 231048 ?       Ss   21:32   0:00 /home/gpadmin/gpdb/release/bin/postgres -D /home/gpadmin/gpdata/gpdatap3/gpseg2 -p 40002 --gp_dbid=4 --gp_num_contents_in_cluster=3 --silent-mode=true -i -M quiescent --gp_contentid=2</div><div class="line">gpadmin   4947  0.3  2.8 424808 229128 ?       Ss   21:32   0:00 /home/gpadmin/gpdb/release/bin/postgres -D /home/gpadmin/gpdata/gpdatam3/gpseg2 -p 50002 --gp_dbid=7 --gp_num_contents_in_cluster=3 --silent-mode=true -i -M quiescent --gp_contentid=2</div><div class="line">gpadmin   4948  0.3  2.8 426784 230904 ?       Ss   21:32   0:00 /home/gpadmin/gpdb/release/bin/postgres -D /home/gpadmin/gpdata/gpdatap1/gpseg0 -p 40000 --gp_dbid=2 --gp_num_contents_in_cluster=3 --silent-mode=true -i -M quiescent --gp_contentid=0</div><div class="line">gpadmin   5039  0.3  2.5 384580 205840 ?       Ss   21:32   0:00 /home/gpadmin/gpdb/release/bin/postgres -D /home/gpadmin/gpdata/gpmaster/gpseg-1 -p 5432 --gp_dbid=1 --gp_num_contents_in_cluster=3 --silent-mode=true -i -M master --gp_contentid=-1 -x 0 -E</div><div class="line">gpadmin   5306  0.0  0.0  21312  1092 pts/1    S+   21:33   0:00 grep --color=auto bin/postgres</div></pre></td></tr></table></figure></p>
<p>Much the same like how to start the cluster, you can use python script <code>gpstop</code> to stop all the cluster at once.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gpadmin@yshen-ThinkPad-X201:~/gpdb/release/bin$ ./gpstop -d ~/gpdata/gpmaster/gpseg-1/</div></pre></td></tr></table></figure></p>
<h2 id="run-regression-test"><a href="#run-regression-test" class="headerlink" title="run regression test"></a>run regression test</h2><p>The first time cluster is running you can do a regression test to varify the correctness of your code.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">make installcheck-world</div></pre></td></tr></table></figure></p>
<p>It took quite a while to finish all the tests. Later whenever you modify the source code you will have to run the regression test to make sure you do not affect other part of the code.</p>
<h2 id="Connecting-to-greenplum-cluster-using-psql"><a href="#Connecting-to-greenplum-cluster-using-psql" class="headerlink" title="Connecting to greenplum cluster using psql"></a>Connecting to greenplum cluster using psql</h2><p>You can connect to the <code>master segment</code> by  a CLI tool  called <code>psql</code>. The default port is <code>5432</code> and the default database we connect to is <code>postgres</code>.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">gpadmin@yshen-ThinkPad-X201:~/gpdb/release/bin$ ./psql</div><div class="line">psql (8.3.23)</div><div class="line">Type &quot;help&quot; for help.</div><div class="line"></div><div class="line">postgres=# SELECT version();</div><div class="line">                                                                                                version                                     </div><div class="line">                                                            </div><div class="line">--------------------------------------------------------------------------------------------------------------------------------------------</div><div class="line">------------------------------------------------------------</div><div class="line"> PostgreSQL 8.3.23 (Greenplum Database 5.0.0-alpha.0-96-g0701a77 build dev) on x86_64-pc-linux-gnu, compiled by GCC gcc (Ubuntu 5.4.0-6ubunt</div><div class="line">u1~16.04.4) 5.4.0 20160609 compiled on Mar  7 2017 18:25:13</div><div class="line">(1 row)</div></pre></td></tr></table></figure></p>
<p>You can issue a query to find out how the cluster is configured by<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">postgres=# SELECT * from gp_segment_configuration order by 1;</div><div class="line"> dbid | content | role | preferred_role | mode | status | port  |      hostname       | address | replication_port | san_mounts </div><div class="line">------+---------+------+----------------+------+--------+-------+---------------------+---------+------------------+------------</div><div class="line">    1 |      -1 | p    | p              | s    | u      |  5432 | yshen-ThinkPad-X201 | mdw     |                  | </div><div class="line">    2 |       0 | m    | p              | s    | d      | 40000 | yshen-ThinkPad-X201 | sdw1    |            41000 | </div><div class="line">    3 |       1 | p    | p              | s    | u      | 40001 | yshen-ThinkPad-X201 | sdw1    |            41001 | </div><div class="line">    4 |       2 | p    | p              | s    | u      | 40002 | yshen-ThinkPad-X201 | sdw1    |            41002 | </div><div class="line">    5 |       0 | p    | m              | c    | u      | 50000 | yshen-ThinkPad-X201 | sdw1    |            51000 | </div><div class="line">    6 |       1 | m    | m              | s    | u      | 50001 | yshen-ThinkPad-X201 | sdw1    |            51001 | </div><div class="line">    7 |       2 | m    | m              | s    | u      | 50002 | yshen-ThinkPad-X201 | sdw1    |            51002 | </div><div class="line">(7 rows)</div></pre></td></tr></table></figure></p>
<p>Here is some explaination about each column.</p>
<p>dbid : range from 1-N, where master segment is 1, then the primary segment, the last is the mirror segment.</p>
<p>content : master is -1, each primary &amp; mirror segment share the same value since there content is the same.</p>
<p>role : primary or mirror status of a segment is running in.</p>
<p>preferred_role : the original defination of primary or mirror for a segment.</p>
<p>mode : ‘s’ means synchronized. ‘r’ means resyncing. ‘c’ change logging.</p>
<p>status : ‘u’ means up. ‘d’ means down.</p>
<h2 id="Feature-testing"><a href="#Feature-testing" class="headerlink" title="Feature testing"></a>Feature testing</h2><p>Different from the original postgres, greenplum allows you to store your table data separetly on each segment host. The master segment stores only meta-data while each primary/mirror segment store the acutal data.<br>You can setup the distribution key when creating table:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">postgres=# CREATE TABLE tb1 ( id int, name varchar(100)) DISTRIBUTED BY (id);</div><div class="line">CREATE TABLE</div><div class="line">postgres=# \d tb1</div><div class="line">             Table &quot;public.tb1&quot;</div><div class="line"> Column |          Type          | Modifiers </div><div class="line">--------+------------------------+-----------</div><div class="line"> id     | integer                | </div><div class="line"> name   | character varying(100) | </div><div class="line">Distributed by: (id)</div><div class="line"></div><div class="line"></div><div class="line">postgres=# INSERT INTO tb1 values(generate_series(1,1000));</div><div class="line">INSERT 0 1000</div></pre></td></tr></table></figure></p>
<p>After the data is inserted all the data is distribute by ID on each segment host. You can exmain how they are distributed by issuing command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">postgres=# select gp_segment_id,count(*) from tb1 group by 1 order by 1;</div><div class="line"> gp_segment_id | count </div><div class="line">---------------+-------</div><div class="line">             0 |   321</div><div class="line">             1 |   342</div><div class="line">             2 |   337</div><div class="line">(3 rows)</div></pre></td></tr></table></figure></p>
<p>Or you can find out which segment a specific tuple is reside by the system column <code>gp_segment_id</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">postgres=# SELECT gp_segment_id , * from tb1 where id = 99;</div><div class="line"> gp_segment_id | id |       name        </div><div class="line">---------------+----+-------------------</div><div class="line">             2 | 99 | 0.459008027799428</div><div class="line">(1 row)</div></pre></td></tr></table></figure>
<p>When you query some data from the cluster. The plan is parallized, each segment is execute a seq scan on its part of data and gathered by the master host</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">postgres=# EXPLAIN SELECT * FROM tb1;</div><div class="line">                                   QUERY PLAN                                    </div><div class="line">---------------------------------------------------------------------------------</div><div class="line"> Gather Motion 3:1  (slice1; segments: 3)  (cost=0.00..13.00 rows=1000 width=22)</div><div class="line">   -&gt;  Seq Scan on tb1  (cost=0.00..13.00 rows=334 width=22)</div><div class="line">(2 rows)</div></pre></td></tr></table></figure>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="dependences-might-have-to-be-installed"><a href="#dependences-might-have-to-be-installed" class="headerlink" title="dependences might have to be installed"></a>dependences might have to be installed</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">sudo apt install libapr1-dev   libevent-dev </div><div class="line">sudo apt install  libxml2*</div><div class="line">sudo apt install libcurl3-dev</div><div class="line">sudo apt install libghc-bzlib-dev</div><div class="line">sudo apt install libyaml-dev</div><div class="line">sudo apt install libpython-all-dev</div><div class="line">sudo apt install libperl-dev</div><div class="line">sudo apt install libpython-all-dev</div><div class="line">sudo apt install python-py  pip</div></pre></td></tr></table></figure>
<h3 id="cannot-establish-ssh-access-into-the-local-host"><a href="#cannot-establish-ssh-access-into-the-local-host" class="headerlink" title="cannot establish ssh access into the local host"></a>cannot establish ssh access into the local host</h3><p>if you see the following erro message:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ gpssh-exkeys -f ../conf/all_hosts </div><div class="line">[STEP 1 of 5] create local ID and authorize on local host</div><div class="line">  ... /home/yshen/.ssh/id_rsa file exists ... key generation skipped</div><div class="line">[ERROR yshen-ThinkPad-X201] authentication check failed:</div><div class="line">     ssh: connect to host yshen-thinkpad-x201 port 22: Connection refused</div><div class="line">[ERROR] cannot establish ssh access into the local host</div></pre></td></tr></table></figure></p>
<p>that means you have’t install ssh-server on your os, run the following commands to do so:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$  sudo apt-get install openssh-server</div><div class="line">$ sudo /etc/init.d/ssh start</div><div class="line">[ ok ] Starting ssh (via systemctl): ssh.service.</div></pre></td></tr></table></figure></p>
<h3 id="bad-password"><a href="#bad-password" class="headerlink" title="bad password"></a>bad password</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">$ gpssh-exkeys -f ../conf/all_hosts </div><div class="line">[STEP 1 of 5] create local ID and authorize on local host</div><div class="line">  ... /home/yshen/.ssh/id_rsa file exists ... key generation skipped</div><div class="line"></div><div class="line">[STEP 2 of 5] keyscan all hosts and update known_hosts file</div><div class="line"></div><div class="line">[STEP 3 of 5] authorize current user on remote hosts</div><div class="line">  ... send to mdw</div><div class="line">  ***</div><div class="line">  *** Enter password for mdw: </div><div class="line">[ERROR mdw] bad password</div><div class="line">  ***</div><div class="line">  *** Enter password for mdw: </div><div class="line">[ERROR mdw] bad password</div><div class="line">  ***</div><div class="line">  *** Enter password for mdw: </div><div class="line">[ERROR mdw] bad password</div><div class="line">  ***</div><div class="line">  *** Enter password for mdw:</div></pre></td></tr></table></figure>
<p>If you met the above error message, means you are not logged in as gpadmin user.</p>
<h3 id="No-module-named-paramiko"><a href="#No-module-named-paramiko" class="headerlink" title="No module named paramiko"></a>No module named paramiko</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ./gpssh-exkeys -f ../conf/all_hosts </div><div class="line">Error: unable to import module: No module named paramiko</div></pre></td></tr></table></figure>
<p>You are missing some of the python libs.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install paramiko psutil</div></pre></td></tr></table></figure></p>
<h3 id="cannot-run-the-python-script-under-GPHOME-bin-dir"><a href="#cannot-run-the-python-script-under-GPHOME-bin-dir" class="headerlink" title="cannot run the python script under $GPHOME/bin dir"></a>cannot run the python script under $GPHOME/bin dir</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">~/gpdb/release/bin$ export PYTHONPATH=~/gpdb/gpMgmt/bin/ext:$PYTHONPATH</div></pre></td></tr></table></figure>
<h3 id="ImportError-No-module-named-lockfile-pidlockfile"><a href="#ImportError-No-module-named-lockfile-pidlockfile" class="headerlink" title="ImportError: No module named lockfile.pidlockfile"></a>ImportError: No module named lockfile.pidlockfile</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ ./gpstart -a</div><div class="line">Traceback (most recent call last):</div><div class="line">  File &quot;./gpstart&quot;, line 9, in &lt;module&gt;</div><div class="line">    from gppylib.mainUtils import *</div><div class="line">  File &quot;/home/gpadmin/gpdb/release/lib/python/gppylib/mainUtils.py&quot;, line 37, in &lt;module&gt;</div><div class="line">    from lockfile.pidlockfile import PIDLockFile, LockTimeout</div><div class="line">ImportError: No module named lockfile.pidlockfile</div><div class="line">```You are missing some of the python libs.</div><div class="line">You are missing some of the python libs.</div></pre></td></tr></table></figure>
<p>pip install lockfile<br>```</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术分享/">技术分享</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Greenplum/">Greenplum</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-nextcloud——搭建自己的云盘" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/05/nextcloud——搭建自己的云盘/" class="article-date">
      <time datetime="2017-03-05T10:50:22.000Z" itemprop="datePublished">2017-03-05</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/05/nextcloud——搭建自己的云盘/">nextcloud——搭建自己的云盘</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>最近多家云盘相继关停，费了很多时间才把上面的东西下载到本地，而且各大云盘都限速500KB/s，尤其是百度云上的小电影都变成了8秒。技术宅岂能容忍？是时候搭建自己的私有云盘了！</p>
</blockquote>
<p>搭建自己的私有云有什么好处呢？首先没有什么容量、下载速度的限制，而且本地访问速度很快。然后可以和本地的cifs、ftp配合使用来实现多个设备文件共享：比如可以在电视、手机等等智能设备上挂载云盘中的文件来实现播放电影、看照片、听歌等需求。最后可以防止泄密和和谐^_^</p>
<p>说到私有云，其实有很多现成的产品可以使用，比如群晖、铁威马、西数等。买过来，插上一块硬盘就可以用，十分适合小白。但是成本略高，仅仅主机就需要1000多元，再加上一块硬盘，这种解决方案的成本一般都要超过2000元。自己搭建私有云的话，不仅成本很低，而且可以自己定制很多功能，比如在线笔记、邮件等等功能。但是需要会折腾linux哦！</p>
<p>自己搭建私有云其实很简单，首先需要一台主机，然后需要选择一个私有云软件（比如ownCloud、nextCloud、seafile）。在这里我还是用我的树莓派作为主机，虽然IO能力差了点，大概上传下载为2MB/s（无线），但是足够自己日常使用而且很省电。在对比几个不同的私有云软件之后，最终采用了nextCloud，感觉这个功能更为强大。具体如何搭建和配置nextCloud，它的<a href="https://nextcloud.com/" target="_blank" rel="external">官网</a>上说的很清楚，在这里就不再赘述了。搭建很快，最后的效果如下：</p>
<center><img src="http://static.zybuluo.com/shenyuflying/iqi9hampq8pdkmqfoptmoszr/image_1baf0hai9veg123ib61dbe7blm.png" alt="image_1baf0hai9veg123ib61dbe7blm.png-250.6kB"></center><br><center>登录界面</center>


<center><img src="http://static.zybuluo.com/shenyuflying/vn1xzj23galuj8mihi3tm3hd/image_1baf0gev81c3bhhl1mae3a21uh49.png" alt="image_1baf0gev81c3bhhl1mae3a21uh49.png-32.1kB"></center><br><center>首页</center>

<p>nextCloud提供了一个大气的web界面，实现了基本的文件上传、下载、图片视频预览等基本功能。然而其强大之处就是可以安装<a href="https://apps.nextcloud.com/" target="_blank" rel="external">apps</a>来实现云盘的功能扩展。</p>
<h2 id="外部存储"><a href="#外部存储" class="headerlink" title="外部存储"></a>外部存储</h2><p>在这里我用到了<strong>外部存储app</strong>来挂载诸多本地的资源，比如移动硬盘、smb/cifs等。</p>
<center><img src="http://static.zybuluo.com/shenyuflying/s0ksgdqnowh9nws8l67wp544/image_1baf176hj7qr12ltkum1c0vfj213.png" alt="image_1baf176hj7qr12ltkum1c0vfj213.png-70.7kB"></center>

<h2 id="在线笔记"><a href="#在线笔记" class="headerlink" title="在线笔记"></a>在线笔记</h2><p>另外用到了<strong>在线笔记app</strong>，这样可以有自己的在线笔记了，支持markdown语法而且是存储在本机的哦！</p>
<center><img src="http://static.zybuluo.com/shenyuflying/t7ok5ieds41aa3tdkmddvjmu/image_1baf1g8jfbl1934gecen2apm1g.png" alt="image_1baf1g8jfbl1934gecen2apm1g.png-23.1kB"></center>

<h2 id="markdown-editor"><a href="#markdown-editor" class="headerlink" title="markdown editor"></a>markdown editor</h2><p>最后可以<strong>markdown editor</strong>实现在线写博客，这样不用每次麻烦ssh登录到服务器来发布博客了。</p>
<center><img src="http://static.zybuluo.com/shenyuflying/m0off98icgxcnlfqjdo5gki2/image_1baf1m16ql8t1nnpgmmuac1u8a1t.png" alt="image_1baf1m16ql8t1nnpgmmuac1u8a1t.png-238.3kB"></center>

<p>功能是不是很强大，nextCloud你值得拥有！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术分享/">技术分享</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nas/">nas</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nextcloud/">nextcloud</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-how-to-change-your-linux-timezone" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/16/how-to-change-your-linux-timezone/" class="article-date">
      <time datetime="2017-02-16T00:16:22.000Z" itemprop="datePublished">2017-02-16</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/16/how-to-change-your-linux-timezone/">how to set your linux&#39;s timezone</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>my blog post time seems not correct these days. but time is fetched from the internet, so it is verly likely caused by an incorrect timezone setting of the linux server.</p>
</blockquote>
<p>type a few commands to see which timezone is set.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~/hexo-blog $ date</div><div class="line">2017年  3月  4日 星期六 13:47:09 UTC</div><div class="line">pi@raspberrypi:~/hexo-blog $ date -R</div><div class="line">Sat, 04 Mar 2017 13:47:14 +0000</div></pre></td></tr></table></figure></p>
<p>opps, the timezone is +0, but we are in china, the timezone shoud be +8</p>
<p>then use <code>tzselect</code> to set the correct timezone now!</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~/hexo-blog $ sudo tzselect</div><div class="line">Please identify a location so that time zone rules can be set correctly.</div><div class="line">Please select a continent, ocean, &quot;coord&quot;, or &quot;TZ&quot;.</div><div class="line"> 1) Africa</div><div class="line"> 2) Americas</div><div class="line"> 3) Antarctica</div><div class="line"> 4) Arctic Ocean</div><div class="line"> 5) Asia</div><div class="line"> 6) Atlantic Ocean</div><div class="line"> 7) Australia</div><div class="line"> 8) Europe</div><div class="line"> 9) Indian Ocean</div><div class="line">10) Pacific Ocean</div><div class="line">11) coord - I want to use geographical coordinates.</div><div class="line">12) TZ - I want to specify the time zone using the Posix TZ format.</div><div class="line">#? 5</div><div class="line">Please select a country whose clocks agree with yours.</div><div class="line"> 1) Afghanistan		  18) Israel		    35) Palestine</div><div class="line"> 2) Armenia		  19) Japan		    36) Philippines</div><div class="line"> 3) Azerbaijan		  20) Jordan		    37) Qatar</div><div class="line"> 4) Bahrain		  21) Kazakhstan	    38) Russia</div><div class="line"> 5) Bangladesh		  22) Korea (North)	    39) Saudi Arabia</div><div class="line"> 6) Bhutan		  23) Korea (South)	    40) Singapore</div><div class="line"> 7) Brunei		  24) Kuwait		    41) Sri Lanka</div><div class="line"> 8) Cambodia		  25) Kyrgyzstan	    42) Syria</div><div class="line"> 9) China		  26) Laos		    43) Taiwan</div><div class="line">10) Cyprus		  27) Lebanon		    44) Tajikistan</div><div class="line">11) East Timor		  28) Macau		    45) Thailand</div><div class="line">12) Georgia		  29) Malaysia		    46) Turkmenistan</div><div class="line">13) Hong Kong		  30) Mongolia		    47) United Arab Emirates</div><div class="line">14) India		  31) Myanmar (Burma)	    48) Uzbekistan</div><div class="line">15) Indonesia		  32) Nepal		    49) Vietnam</div><div class="line">16) Iran		  33) Oman		    50) Yemen</div><div class="line">17) Iraq		  34) Pakistan</div><div class="line">#? 9</div><div class="line">Please select one of the following time zone regions.</div><div class="line">1) Beijing Time</div><div class="line">2) Xinjiang Time</div><div class="line">#? 1</div><div class="line"></div><div class="line">The following information has been given:</div><div class="line"></div><div class="line">	China</div><div class="line">	Beijing Time</div><div class="line"></div><div class="line">Therefore TZ=&apos;Asia/Shanghai&apos; will be used.</div><div class="line">Local time is now:	Sat Mar  4 21:46:15 CST 2017.</div><div class="line">Universal Time is now:	Sat Mar  4 13:46:15 UTC 2017.</div><div class="line">Is the above information OK?</div><div class="line">1) Yes</div><div class="line">2) No</div><div class="line">#? 1</div><div class="line"></div><div class="line">You can make this change permanent for yourself by appending the line</div><div class="line">	TZ=&apos;Asia/Shanghai&apos;; export TZ</div><div class="line">to the file &apos;.profile&apos; in your home directory; then log out and log in again.</div><div class="line"></div><div class="line">Here is that TZ value again, this time on standard output so that you</div><div class="line">can use the /usr/bin/tzselect command in shell scripts:</div><div class="line">Asia/Shanghai</div></pre></td></tr></table></figure>
<p>let’s see if the time is correct now:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~/hexo-blog $ date</div><div class="line">2017年  3月  4日 星期六 13:47:09 UTC</div><div class="line">pi@raspberrypi:~/hexo-blog $ date -R</div><div class="line">Sat, 04 Mar 2017 13:47:14 +0000</div></pre></td></tr></table></figure>
<p>still incorrect! may be we should follow the instruction above, say we have to set TZ in the .profile and logout/login.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~/hexo-blog $ echo &quot;TZ=&apos;Asia/Shanghai&apos;; export TZ&quot; &gt;&gt; ~/.profile </div><div class="line">pi@raspberrypi:~/hexo-blog $ exit</div><div class="line">logout</div><div class="line"></div><div class="line">Connection closed by foreign host.</div><div class="line"></div><div class="line">Disconnected from remote host(pi) at 21:48:00.</div><div class="line"></div><div class="line">Type `help&apos; to learn how to use Xshell prompt.</div><div class="line">[d:\~]$ </div><div class="line"></div><div class="line">Connecting to 192.168.1.10:22...</div><div class="line">Connection established.</div><div class="line">To escape to local shell, press &apos;Ctrl+Alt+]&apos;.</div><div class="line"></div><div class="line"></div><div class="line">The programs included with the Debian GNU/Linux system are free software;</div><div class="line">the exact distribution terms for each program are described in the</div><div class="line">individual files in /usr/share/doc/*/copyright.</div><div class="line"></div><div class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</div><div class="line">permitted by applicable law.</div><div class="line">Last login: Sat Mar  4 12:09:50 2017 from 192.168.1.111</div><div class="line">pi@raspberrypi:~ $ date</div><div class="line">2017年  3月  4日 星期六 21:48:13 CST</div></pre></td></tr></table></figure>
<p>ok, we are done!</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术分享/">技术分享</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-科学上网——搭建自己的DNS服务器" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/16/科学上网——搭建自己的DNS服务器/" class="article-date">
      <time datetime="2017-02-16T00:16:22.000Z" itemprop="datePublished">2017-02-16</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/16/科学上网——搭建自己的DNS服务器/">科学上网——搭建自己的DNS服务器</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>DNS（Domain Name Server）故名思议就是把把域名解析为IP地址。为啥要自己搭DNS服务器呢？好处主要有以下几个：（1）通过缓存来提高域名解析的速度。（2）通过域名指向正确的IP地址能够访问被wall的网站。（3）通过域名指向无效的IP地址来过滤网站的广告。那么这篇文章就带领你搭建自己的DNS服务器来实现上述功能。</p>
</blockquote>
<p>首先你需要一台主机来做DNS服务器：可以用普通电脑，或者树莓派，或者一个路由器刷openwrt系统。其设置都是大同小异。这里我用树莓派，比较省电，可以7x24小时开机、性能也还不错。</p>
<center> <img src="http://static.zybuluo.com/shenyuflying/dn5f81hxruayw9fcy79ox4u6/image_1b92v70v7a93gac1ofog7k1no29.png" alt="image_1b92v70v7a93gac1ofog7k1no29.png-172.7kB"> </center>

<h2 id="安装dnsmasq"><a href="#安装dnsmasq" class="headerlink" title="安装dnsmasq"></a>安装dnsmasq</h2><p>dnsmasq是linux下的一个轻量级DHCP和DNS服务器。在这里我们只用到它的DNS服务。那我们先把它装好：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt install dnsmasq -y</div></pre></td></tr></table></figure></p>
<p>把如下配置项加入<code>/etc/dnsmasq.conf</code>里<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">listen-address=127.0.0.1,192.168.1.10</div><div class="line">cache-size=15000</div></pre></td></tr></table></figure></p>
<p>这个地址<code>192.168.1.10</code>就是树莓派的固定IP。<br>设置好之后我们通过<code>service dnsmasq status</code>能看到服务是否跑起来了。</p>
<h2 id="设置hosts"><a href="#设置hosts" class="headerlink" title="设置hosts"></a>设置hosts</h2><p><a href="https://github.com/racaljk/hosts" target="_blank" rel="external">这里</a>提供了能访问很多被wall网站的hosts<br><a href="https://github.com/vokins/yhosts" target="_blank" rel="external">这里</a>提供了能去广告的hosts<br>下面我们需要把这些hosts加入到本机的<code>/etc/hosts</code>文件里面，我写了一个脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line"></div><div class="line"># script to update the hosts file</div><div class="line"></div><div class="line"># Must be run as root</div><div class="line">if [[ `whoami` != &quot;root&quot; ]]</div><div class="line">then</div><div class="line">  echo &quot;This install must be run as root or with sudo.&quot;</div><div class="line">  exit</div><div class="line">fi</div><div class="line"></div><div class="line">DATE=`date`</div><div class="line"></div><div class="line">cp /etc/hosts /etc/hosts.bak</div><div class="line">echo &quot;&quot; &gt; /etc/hosts</div><div class="line"></div><div class="line"># for google, wiki, etc.</div><div class="line">git clone https://github.com/racaljk/hosts</div><div class="line">cat hosts/hosts &gt;&gt; /etc/hosts</div><div class="line">rm -rf hosts</div><div class="line"></div><div class="line"># wipe out ads</div><div class="line">git clone https://github.com/vokins/yhosts</div><div class="line">cat yhosts/hosts &gt;&gt; /etc/hosts</div><div class="line">rm -rf yhosts</div><div class="line"></div><div class="line"># delete some entry: taobao alipay ...</div><div class="line">sed -i &apos;/taobao/d&apos; /etc/hosts</div><div class="line">sed -i &apos;/alipay/d&apos; /etc/hosts</div><div class="line"></div><div class="line"># restart the dns server</div><div class="line">service dnsmasq restart</div><div class="line"></div><div class="line">echo &quot;updated at &quot;$DATE &gt;&gt; update_hosts.log</div></pre></td></tr></table></figure></p>
<p>接下来把这个脚本加入定时任务<code>crontab -e</code>，设为每周执行一次来获取最新的hosts。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># m h  dom mon dow   command</div><div class="line">0 0 * * 1 /root/update_hosts.sh</div></pre></td></tr></table></figure></p>
<h2 id="配置路由器"><a href="#配置路由器" class="headerlink" title="配置路由器"></a>配置路由器</h2><p>接下来需要把路由器的首选DNS服务器设置为我们刚刚搭建的DNS服务器的IP地址<code>192.168.1.10</code>。设置完之后你的手机、平板、电脑等设备就会在每次接入路由器的时候从路由器获取DNS。当然也可以挨个设置每个设备的DNS。很显然，因此如果你有多个设备比如手机平板的话，在路由器统一设置比较方便。</p>
<center> <img src="http://static.zybuluo.com/shenyuflying/o40fxl4rt87oui5ikbqonsl6/image_1b8uf1bb49o41hh6eakk0ugn9.png" alt="image_1b8uf1bb49o41hh6eakk0ugn9.png-63.3kB"> </center>



<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><table>
<thead>
<tr>
<th>网站</th>
<th>网址</th>
<th>是否能访问</th>
</tr>
</thead>
<tbody>
<tr>
<td>谷歌</td>
<td><a href="https://www.google.com.hk" target="_blank" rel="external">https://www.google.com.hk</a></td>
<td>OK</td>
</tr>
<tr>
<td>YouTube</td>
<td><a href="https://www.youtube.com" target="_blank" rel="external">https://www.youtube.com</a></td>
<td>OK</td>
</tr>
<tr>
<td>维基百科</td>
<td><a href="https://www.wikipedia.org" target="_blank" rel="external">https://www.wikipedia.org</a></td>
<td>OK</td>
</tr>
<tr>
<td>Facebook</td>
<td><a href="https://www.facebook.com" target="_blank" rel="external">https://www.facebook.com</a></td>
<td>OK</td>
</tr>
<tr>
<td>twitter</td>
<td><a href="https://www.facebook.com" target="_blank" rel="external">https://www.facebook.com</a></td>
<td>OK</td>
</tr>
</tbody>
</table>
<p>有些网站需要用https协议才能正常访问，所以需要输入https打头的地址。</p>
<p>另外好多原来被wall的app都可以用了，好多视频网站的广告也消失了。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://wiki.archlinux.org/index.php/Dnsmasq" target="_blank" rel="external">https://wiki.archlinux.org/index.php/Dnsmasq</a><br><a href="http://debugo.com/dnsmasq/" target="_blank" rel="external">http://debugo.com/dnsmasq/</a><br><a href="http://www.heystephenwood.com/2013/06/use-your-raspberry-pi-as-dns-cache-to.html" target="_blank" rel="external">http://www.heystephenwood.com/2013/06/use-your-raspberry-pi-as-dns-cache-to.html</a></p>
<p>如果还想看到更多此类文章，请移步到<a href="http://shenyu.wiki">小宇的博客</a>。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术分享/">技术分享</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dns/">dns</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dnsmasq/">dnsmasq</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/">web</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/树莓派/">树莓派</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-如何阅读程序源码之——call-graph" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/14/如何阅读程序源码之——call-graph/" class="article-date">
      <time datetime="2017-02-13T17:58:20.000Z" itemprop="datePublished">2017-02-14</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/14/如何阅读程序源码之——call-graph/">如何阅读程序源码之——call graph</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>多阅读大型开源项目能够显著提升自己的能力，但是面对几万甚至几十万行的代码是不是感觉无从下手。理解大型工程的一个诀窍就是能够理清函数之间的调用关系。这篇文章介绍几个好用的工具，用来帮助我们生成代码的调用关系，以便更好的理解项目代码。</p>
</blockquote>
<p>说到函数调用关系（call graph）相信大家都不陌生，函数调用关系其实就是程序的执行流程。生成函数调用关系的方法一般来说有2个，即动态方法和静态方法。</p>
<h2 id="动态方法"><a href="#动态方法" class="headerlink" title="动态方法"></a>动态方法</h2><p>动态方法就是在程序执行过程中，把函数的调用情况记录下来，一些程序性能分析工具常常都有这个功能，比如<code>gprof</code>。相对于静态方法来说，动态方法准确的反映了程序执行的过程。但是一些没有实际执行到的分支没有显示出来。<br>常用的工具有：</p>
<ol>
<li><a href="https://sourceware.org/binutils/docs/gprof/" target="_blank" rel="external">gprof</a>：可以输出每个函数的调用次数，每个函数消耗的处理器时间，函数之间的调用关系。通过在编译和链接程序的时候（使用 -pg 编译和链接选项），gcc 在你应用程序的每个函数中都加入了一个名为mcount函数，也就是说你的应用程序里的每一个函数都会调用mcount，而mcount会在内存中保存一张函数调用图，并通过函数调用堆栈的形式查找子函数和父函数的地址。这张调用图也保存了所有与函数相关的调用时间，调用次数等等的所有信息。在程序结束后会生成gmon.out文件，然后再用gprof来分析gmon.out文件。但是gprof不支持多线程应用，多线程下只能采集主线程性能数据。原因是gprof采用ITIMER_PROF信号，在多线程内只有主线程才能响应该信号。如果需要支持多线程程序那么需要程序员自己处理线程信号。另外gprof只能输出文本形式的调用关系。</li>
<li><a href="http://kcachegrind.sourceforge.net/html/Home.html" target="_blank" rel="external">KCachegrind</a>：利用calgrind生成的结果，绘制调用关系图形。使用也非常简单,首先用valgrind来执行程序<code>valgrind --tools=callgrind ./prog</code>，程序结束后在目录下生成<code>callgrind.out.pid</code>文件，然后用kcachegrind打开这个文件即可。</li>
</ol>
<h2 id="静态方法"><a href="#静态方法" class="headerlink" title="静态方法"></a>静态方法</h2><p>静态方法就是直接分析程序源码文件，把函数调用关系记录下来。静态方法能够更为全面的反映函数的调用情况（不管实际是否能调用）。相对于动态方法来说，静态方法不用编译，速度较快节约了大量时间。但是，静态方法的函数调用关系不一定能够反映程序的实际执行情况。<br>常用的工具有：</p>
<ol>
<li><a href="http://www.doxygen.nl/manual/index.html" target="_blank" rel="external">doxygen</a>：可由代码以生成html等各种格式的文档，需要编码时按照一定的规范，十分适合大型工程，可以看<a href="https://doxygen.postgresql.org/" target="_blank" rel="external">postgresql</a>的在线文档。但是已有工程由于不符合doxygen的规范，不适合使用。</li>
<li><a href="http://www.gnu.org/software/cflow/" target="_blank" rel="external">cflow</a>：直接解析C源代码，用lex&amp;yacc来生成文本格式的调用关系图。不需要任何改动。但是只能生成文本格式，不能生成图像。</li>
<li><a href="http://www.gson.org/egypt/egypt.html" target="_blank" rel="external">egypt</a>：用gcc的-fdump-rtl-expand选项生成调用关系，然后用graphviz生成调用图图像。需要简单改动一下Makefile,或者是make CFLAGS=”-fdump-rtl-expand”。</li>
<li><a href="http://www.vim.org/scripts/script.php?script_id=2368" target="_blank" rel="external">CCTree</a>：这个是vim的一个插件，利用cscope的输出来生成交叉引用的信息。和SourceInsight的交叉引用很像。</li>
<li><a href="http://freecode.com/projects/codeviz/" target="_blank" rel="external">codeviz</a> :其基本原理是给 GCC 打个补丁，让它在编译时每个源文件时 dump 出其中函数的 call graph，然后用 Perl 脚本收集并整理调用关系，转交给Graphviz绘制图形。这种方法还需要重新编译gcc，比较麻烦。</li>
</ol>
<p>动态方法和静态方法各有好处，在实际使用过程中需要两者相结合才会发挥更大力量。下面是他们生成的调用关系效果图：</p>
<ol>
<li>gprof</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line">$ gprof -b ./node2dot ./gmon.out </div><div class="line">Flat profile:</div><div class="line"></div><div class="line">Each sample counts as 0.01 seconds.</div><div class="line">  %   cumulative   self              self     total           </div><div class="line"> time   seconds   seconds    calls  ms/call  ms/call  name    </div><div class="line">100.22      0.03     0.03        8     3.76     3.76  add_node</div><div class="line">  0.00      0.03     0.00       54     0.00     0.00  get_one_name</div><div class="line">  0.00      0.03     0.00       32     0.00     0.00  add_item</div><div class="line">  0.00      0.03     0.00       16     0.00     0.00  pop</div><div class="line">  0.00      0.03     0.00       16     0.00     0.00  push</div><div class="line">  0.00      0.03     0.00        8     0.00     0.00  add_link</div><div class="line">  0.00      0.03     0.00        1     0.00     0.00  print_body</div><div class="line">  0.00      0.03     0.00        1     0.00     0.00  print_footer</div><div class="line">  0.00      0.03     0.00        1     0.00     0.00  print_header</div><div class="line"></div><div class="line"></div><div class="line">			Call graph</div><div class="line"></div><div class="line"></div><div class="line">granularity: each sample hit covers 2 byte(s) for 33.26% of 0.03 seconds</div><div class="line"></div><div class="line">index % time    self  children    called     name</div><div class="line">                0.03    0.00       8/8           main [2]</div><div class="line">[1]    100.0    0.03    0.00       8         add_node [1]</div><div class="line">-----------------------------------------------</div><div class="line">                                                 &lt;spontaneous&gt;</div><div class="line">[2]    100.0    0.00    0.03                 main [2]</div><div class="line">                0.03    0.00       8/8           add_node [1]</div><div class="line">                0.00    0.00      54/54          get_one_name [3]</div><div class="line">                0.00    0.00      32/32          add_item [4]</div><div class="line">                0.00    0.00      16/16          push [6]</div><div class="line">                0.00    0.00      16/16          pop [5]</div><div class="line">                0.00    0.00       8/8           add_link [7]</div><div class="line">                0.00    0.00       1/1           print_header [10]</div><div class="line">                0.00    0.00       1/1           print_footer [9]</div><div class="line">                0.00    0.00       1/1           print_body [8]</div><div class="line">-----------------------------------------------</div><div class="line">                0.00    0.00      54/54          main [2]</div><div class="line">[3]      0.0    0.00    0.00      54         get_one_name [3]</div><div class="line">-----------------------------------------------</div><div class="line">                0.00    0.00      32/32          main [2]</div><div class="line">[4]      0.0    0.00    0.00      32         add_item [4]</div><div class="line">-----------------------------------------------</div><div class="line">                0.00    0.00      16/16          main [2]</div><div class="line">[5]      0.0    0.00    0.00      16         pop [5]</div><div class="line">-----------------------------------------------</div><div class="line">                0.00    0.00      16/16          main [2]</div><div class="line">[6]      0.0    0.00    0.00      16         push [6]</div><div class="line">-----------------------------------------------</div><div class="line">                0.00    0.00       8/8           main [2]</div><div class="line">[7]      0.0    0.00    0.00       8         add_link [7]</div><div class="line">-----------------------------------------------</div><div class="line">                0.00    0.00       1/1           main [2]</div><div class="line">[8]      0.0    0.00    0.00       1         print_body [8]</div><div class="line">-----------------------------------------------</div><div class="line">                0.00    0.00       1/1           main [2]</div><div class="line">[9]      0.0    0.00    0.00       1         print_footer [9]</div><div class="line">-----------------------------------------------</div><div class="line">                0.00    0.00       1/1           main [2]</div><div class="line">[10]     0.0    0.00    0.00       1         print_header [10]</div><div class="line">-----------------------------------------------</div><div class="line"></div><div class="line"></div><div class="line">Index by function name</div><div class="line"></div><div class="line">   [4] add_item                [3] get_one_name            [9] print_footer</div><div class="line">   [7] add_link                [5] pop                    [10] print_header</div><div class="line">   [1] add_node                [8] print_body              [6] push</div></pre></td></tr></table></figure>
<ol>
<li>kcachegrind<center><img src="http://static.zybuluo.com/shenyuflying/bz18v8q1z4vif7o5h9lpepra/image_1b8t50qjn1p7f9i0bjs1qud1cqc9.png" alt="image_1b8t50qjn1p7f9i0bjs1qud1cqc9.png-253.8kB"></center></li>
<li>egypt <center><img src="http://static.zybuluo.com/shenyuflying/4n143s2us4sxph95uhh5tbij/image_1b8renepf1ckbd1d1qjk1ikv4a0m.png" alt="image_1b8renepf1ckbd1d1qjk1ikv4a0m.png-42.6kB"></center></li>
<li>CCTree<center><img src="http://static.zybuluo.com/shenyuflying/rt5utk4711iyfaoo77c2anem/image_1b8rei332c4v1ppefci182muf49.png" alt="image_1b8rei332c4v1ppefci182muf49.png-128.3kB"></center>

</li>
</ol>
<p>PS:以上分析的源码来自我的两个开源项目：<br>pgNodeGraph: <a href="http://github.com/shenyuflying/pgNodeGraph" target="_blank" rel="external">http://github.com/shenyuflying/pgNodeGraph</a><br>codeRunner: <a href="http://github.com/shenyuflying/codeRunner" target="_blank" rel="external">http://github.com/shenyuflying/codeRunner</a></p>
<p>如果还想看到更多此类文章，请移步到<a href="http://shenyu.wiki">小宇的博客</a>。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术分享/">技术分享</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cctree/">cctree</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cflow/">cflow</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codeviz/">codeviz</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/doxygen/">doxygen</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/egypt/">egypt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gprof/">gprof</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kcachegrind/">kcachegrind</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/valgrind/">valgrind</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/工具/">工具</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2014-2017 小宇
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>